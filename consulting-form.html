<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1WRB9MHF42"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-1WRB9MHF42');
    </script>

    <meta charset="UTF-8">
    <title>Consultation</title>
    <link rel="icon" href="images/tree.ico" type="image/x-icon">
    <meta name="description" content="Raysor LLC Consulting">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/animate.css">
    <script>
        function submitForm() {
            // Get form data
            var formData = new FormData(document.getElementById("contactForm"));
    
            // Send form data to API
            fetch("https://pu4o1bnhyb.execute-api.us-east-2.amazonaws.com/MailFormSubmission/submit-form", {
                method: "POST",
                headers: {
                    // Explicitly set content type to avoid issues
                    "Content-Type": "application/x-www-form-urlencoded",
                },
                body: new URLSearchParams(formData).toString(),
            })
            .then(response => response.json())
            .then(data => {
                console.log("Success:", data);
                
                window.location.href = "index.html";
            })
            .catch(error => {
                console.error("Error:", error);
            });
        }
    </script>
    <script>
    async function validateAndSubmit() {
            // Get form data
            var contactForm = {
                name: document.getElementById("name").value,
                email: document.getElementById("email").value,
                phone_number: document.getElementById("phone_number").value,
                idea: document.getElementById("idea").value
            };
    
            // Validate each required field
            for (var key in contactForm) {
                if (contactForm.hasOwnProperty(key) && document.getElementById(key).hasAttribute("required")) {
                    if (contactForm[key].trim() === "") {
                        alert("Please fill in all required fields.");
                        return; // Stop the submission if any required field is empty
                    }
                    if (key === "email" && !isValidEmail(contactForm[key])) {
                        alert("Please enter a valid email address.");
                        return;
                    }
    
                    if (key === "phone_number" && !isValidPhoneNumber(contactForm[key])) {
                        alert("Please enter a valid phone number.");
                        return;
                    }
                }
            }
    
            submitForm();
        }
    
        // Function to validate email format
        function isValidEmail(email) {
            var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
    
        // Function to validate phone number format
        function isValidPhoneNumber(phoneNumber) {
            var phoneRegex = /^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/;
            return phoneRegex.test(phoneNumber);
        }

    </script>
    
    
    <script>
        function redirectToHomepage() {
            window.location.href = 'index.html';
        }
    </script>
</head>

<body class="day">
    <div class="container animated fadeIn one">
    <div class="row group">
        <div class="six columns offset-by-three animated fadeIn three">  
            <form id="contactForm">
                <label for="name">Name *</label>
                <input type="text" id="name" name="name" required>

                <label for="phone_number">Phone Number *</label>
                <input type="tel" id="phone_number" name="phone_number" required>

                <label for="email">Email *</label>
                <input type="email" id="email" name="email" required>

                <label for="idea">Idea *</label>
                <textarea id="idea" name="idea" required></textarea>

                <button type="button" onclick="redirectToHomepage()">Cancel</button>
                <button type="button" onclick="validateAndSubmit()">Send</button>
            </form>
        </div>
    </div>
</div>
</body>
</html>
